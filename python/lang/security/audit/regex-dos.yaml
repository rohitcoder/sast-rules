rules:
- id: regex_dos__njdup
  languages:
  - python
  message: Detected usage of re.compile with an inefficient regular expression. This
    can lead to regular expression denial of service, which can result in service
    down time. Instead, check all regexes or use safer alternatives such as pyre2.
  metadata:
    category: security
    confidence: LOW
    cwe: 'CWE-1333: Inefficient Regular Expression Complexity'
    impact: MEDIUM
    license: Commons Clause License Condition v1.0[LGPL-2.1-only]
    likelihood: LOW
    owasp: A06:2017 - Security Misconfiguration
    references:
    - https://docs.python.org/3/library/re.html
    subcategory:
    - vuln
    technology:
    - python
  patterns:
  - pattern: '$A = re.compile("$B", ...)

      ...

      $A.$METHOD(...)

      '
  - metavariable-analysis:
      analyzer: redos
      metavariable: $B
  - metavariable-regex:
      metavariable: $METHOD
      regex: (?!(escape)|(purge))
  severity: WARNING
