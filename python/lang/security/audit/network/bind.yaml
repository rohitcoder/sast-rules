rules:
- id: avoid-bind-to-all-interfaces__ayuxg
  languages:
  - python
  message: Running `socket.bind` to 0.0.0.0, ::, or empty string could unexpectedly
    expose the server publicly as it binds to all available interfaces. Consider instead
    getting correct address from an environment variable or configuration file.
  metadata:
    category: security
    confidence: HIGH
    cwe:
    - 'CWE-200: Exposure of Sensitive Information to an Unauthorized Actor'
    cwe2021-top25: true
    impact: MEDIUM
    likelihood: HIGH
    owasp:
    - A01:2021 - Broken Access Control
    references:
    - https://owasp.org/Top10/A01_2021-Broken_Access_Control
    subcategory:
    - vuln
    technology:
    - python
  pattern-either:
  - pattern: '$S = socket.socket(...)

      ...

      $S.bind(("0.0.0.0", ...))

      '
  - pattern: '$S = socket.socket(...)

      ...

      $S.bind(("::", ...))

      '
  - pattern: '$S = socket.socket(...)

      ...

      $S.bind(("", ...))

      '
  severity: INFO
