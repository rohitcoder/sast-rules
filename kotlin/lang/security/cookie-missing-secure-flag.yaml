rules:
- id: cookie-missing-secure-flag__glghh
  languages:
  - kt
  message: A cookie was detected without setting the 'secure' flag. The 'secure' flag
    for cookies prevents the client from transmitting the cookie over insecure channels
    such as HTTP. Set the 'secure' flag by calling '$COOKIE.setSecure(true);'
  metadata:
    category: security
    confidence: LOW
    cwe:
    - 'CWE-614: Sensitive Cookie in HTTPS Session Without ''Secure'' Attribute'
    impact: LOW
    likelihood: LOW
    owasp:
    - A05:2021 - Security Misconfiguration
    references:
    - https://owasp.org/Top10/A05_2021-Security_Misconfiguration
    source-rule-url: https://find-sec-bugs.github.io/bugs.htm#INSECURE_COOKIE
    subcategory:
    - audit
    technology:
    - kt
  patterns:
  - pattern-not-inside: '$COOKIE.setValue("")

      ...

      '
  - pattern-either:
    - pattern: $COOKIE.setSecure(false)
    - patterns:
      - pattern-not-inside: '$COOKIE.setSecure(...)

          ...

          '
      - pattern: $RESPONSE.addCookie($COOKIE)
  severity: WARNING
