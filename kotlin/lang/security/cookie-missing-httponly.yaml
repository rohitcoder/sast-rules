rules:
- id: cookie-missing-httponly__pfwbb
  languages:
  - kt
  message: A cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly'
    flag for cookies instructs the browser to forbid client-side scripts from reading
    the cookie. Set the 'HttpOnly' flag by calling 'cookie.setHttpOnly(true);'
  metadata:
    category: security
    confidence: LOW
    cwe:
    - 'CWE-1004: Sensitive Cookie Without ''HttpOnly'' Flag'
    impact: LOW
    likelihood: LOW
    owasp:
    - A05:2021 - Security Misconfiguration
    references:
    - https://owasp.org/Top10/A05_2021-Security_Misconfiguration
    source-rule-url: https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE
    subcategory:
    - audit
    technology:
    - kt
  patterns:
  - pattern-not-inside: '$COOKIE.setValue("")

      ...

      '
  - pattern-either:
    - pattern: $COOKIE.setHttpOnly(false)
    - patterns:
      - pattern-not-inside: '$COOKIE.setHttpOnly(...)

          ...

          '
      - pattern: $RESPONSE.addCookie($COOKIE)
  severity: WARNING
