rules:
- id: ecb-cipher__fcffh
  languages:
  - java
  message: Cipher in ECB mode is detected. ECB mode produces the same output for the
    same input each time which allows an attacker to intercept and replay the data.
    Further, ECB mode does not provide any integrity checking. See https://find-sec-bugs.github.io/bugs.htm#CIPHER_INTEGRITY.
  metadata:
    category: security
    confidence: HIGH
    cwe:
    - 'CWE-327: Use of a Broken or Risky Cryptographic Algorithm'
    impact: MEDIUM
    likelihood: MEDIUM
    owasp:
    - A03:2017 - Sensitive Data Exposure
    - A02:2021 - Cryptographic Failures
    references:
    - https://owasp.org/Top10/A02_2021-Cryptographic_Failures
    source-rule-url: https://find-sec-bugs.github.io/bugs.htm#ECB_MODE
    subcategory:
    - vuln
    technology:
    - java
  patterns:
  - pattern: 'Cipher $VAR = $CIPHER.getInstance($MODE);

      '
  - metavariable-regex:
      metavariable: $MODE
      regex: .*ECB.*
  severity: WARNING
