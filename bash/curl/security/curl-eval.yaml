rules:
- id: curl-eval__hpavs
  languages:
  - bash
  message: Data is being eval'd from a `curl` command. An attacker with control of
    the server in the `curl` command could inject malicious code into the `eval`,
    resulting in a system comrpomise. Avoid eval'ing untrusted data if you can. If
    you must do this, consider checking the SHA sum of the content returned by the
    server to verify its integrity.
  metadata:
    category: security
    confidence: MEDIUM
    cwe:
    - 'CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code
      (''Eval Injection'')'
    impact: MEDIUM
    likelihood: MEDIUM
    owasp:
    - A03:2021 - Injection
    references:
    - https://owasp.org/Top10/A03_2021-Injection
    subcategory:
    - vuln
    technology:
    - bash
    - curl
  mode: taint
  pattern-sinks:
  - pattern: eval ...
  pattern-sources:
  - pattern: '$(curl ...)

      '
  - pattern: '`curl ...`

      '
  severity: WARNING
