rules:
- fix-regex:
    regex: (HttpOnly\s*:\s+)false
    replacement: \1true
  id: cookie-missing-httponly__cnhxb
  languages:
  - go
  message: A session cookie was detected without setting the 'HttpOnly' flag. The
    'HttpOnly' flag for cookies instructs the browser to forbid client-side scripts
    from reading the cookie which mitigates XSS attacks. Set the 'HttpOnly' flag by
    setting 'HttpOnly' to 'true' in the Cookie.
  metadata:
    category: security
    confidence: MEDIUM
    cwe:
    - 'CWE-1004: Sensitive Cookie Without ''HttpOnly'' Flag'
    impact: LOW
    likelihood: LOW
    owasp:
    - A05:2021 - Security Misconfiguration
    references:
    - https://github.com/0c34/govwa/blob/139693e56406b5684d2a6ae22c0af90717e149b8/util/cookie.go
    - https://golang.org/src/net/http/cookie.go
    subcategory:
    - vuln
    technology:
    - go
  patterns:
  - pattern-not-inside: "http.Cookie{\n  ...,\n  HttpOnly: true,\n  ...,\n}\n"
  - pattern: "http.Cookie{\n  ...,\n}\n"
  severity: WARNING
