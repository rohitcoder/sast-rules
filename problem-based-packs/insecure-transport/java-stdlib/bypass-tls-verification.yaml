rules:
- id: bypass-tls-verification__qurtt
  languages:
  - java
  message: Checks for redefinitions of the checkServerTrusted function in the X509TrustManager
    class that disables TLS/SSL certificate verification. This should only be used
    for debugging purposes because it leads to vulnerability to MTM attacks.
  metadata:
    category: security
    confidence: MEDIUM
    cwe: 'CWE-319: Cleartext Transmission of Sensitive Information'
    impact: MEDIUM
    likelihood: MEDIUM
    owasp: A03:2017 - Sensitive Data Exposure
    references:
    - https://riptutorial.com/java/example/16517/temporarily-disable-ssl-verification--for-testing-purposes-
    - https://stackoverflow.com/questions/35530558/how-to-fix-unsafe-implementation-of-x509trustmanager-in-android-app?rq=1
    subcategory:
    - vuln
    technology:
    - java
    vulnerability: Insecure Transport
  patterns:
  - pattern: "new X509TrustManager() {\n  ...\n  public void checkClientTrusted(X509Certificate[]\
      \ certs, String authType) {...}\n  ...\n}\n"
  - pattern-not: "new X509TrustManager() {\n  ...\n  public void checkServerTrusted(X509Certificate[]\
      \ certs, String authType) {\n    ...\n    throw new CertificateException(...);\n\
      \    ...\n  }\n  ...\n}\n"
  - pattern-not: "new X509TrustManager() {\n  ...\n  public void checkServerTrusted(X509Certificate[]\
      \ certs, String authType) {\n    ...\n    throw new IllegalArgumentException(...);\n\
      \    ...\n  }\n  ...\n}\n"
  severity: WARNING
